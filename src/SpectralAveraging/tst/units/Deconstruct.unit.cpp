#include <memory>
#include <gtest/gtest.h>

#include "WCESpectralAveraging.hpp"


using namespace SpectralAveraging;
using namespace FenestrationCommon;

class TestDeconstructors : public testing::Test
{
private:
    std::shared_ptr<CSpectralSampleData> m_SampleData;

protected:
    std::shared_ptr<CSpectralSampleData> getSubstrateMeasurements() const
    {
        std::shared_ptr<CSpectralSampleData> aMeasurements_sub =
          std::make_shared<CSpectralSampleData>();

        aMeasurements_sub->addRecord(300, 0.202, 0.055, 0.055);
        aMeasurements_sub->addRecord(305, 0.277, 0.059, 0.059);
        aMeasurements_sub->addRecord(310, 0.351, 0.063, 0.063);
        aMeasurements_sub->addRecord(315, 0.426, 0.066, 0.066);
        aMeasurements_sub->addRecord(320, 0.505, 0.070, 0.070);
        aMeasurements_sub->addRecord(325, 0.590, 0.073, 0.073);
        aMeasurements_sub->addRecord(330, 0.676, 0.077, 0.077);
        aMeasurements_sub->addRecord(335, 0.751, 0.081, 0.081);
        aMeasurements_sub->addRecord(340, 0.808, 0.084, 0.084);
        aMeasurements_sub->addRecord(345, 0.847, 0.086, 0.086);
        aMeasurements_sub->addRecord(350, 0.873, 0.087, 0.087);
        aMeasurements_sub->addRecord(355, 0.888, 0.087, 0.087);
        aMeasurements_sub->addRecord(360, 0.896, 0.088, 0.088);
        aMeasurements_sub->addRecord(365, 0.901, 0.088, 0.088);
        aMeasurements_sub->addRecord(370, 0.903, 0.087, 0.087);
        aMeasurements_sub->addRecord(375, 0.904, 0.087, 0.087);
        aMeasurements_sub->addRecord(380, 0.904, 0.087, 0.087);
        aMeasurements_sub->addRecord(385, 0.905, 0.087, 0.087);
        aMeasurements_sub->addRecord(390, 0.907, 0.087, 0.087);
        aMeasurements_sub->addRecord(395, 0.908, 0.086, 0.086);
        aMeasurements_sub->addRecord(400, 0.908, 0.086, 0.086);
        aMeasurements_sub->addRecord(405, 0.908, 0.086, 0.086);
        aMeasurements_sub->addRecord(410, 0.908, 0.086, 0.086);
        aMeasurements_sub->addRecord(415, 0.908, 0.086, 0.086);
        aMeasurements_sub->addRecord(420, 0.907, 0.085, 0.085);
        aMeasurements_sub->addRecord(425, 0.908, 0.085, 0.085);
        aMeasurements_sub->addRecord(430, 0.908, 0.085, 0.085);
        aMeasurements_sub->addRecord(435, 0.908, 0.085, 0.085);
        aMeasurements_sub->addRecord(440, 0.909, 0.085, 0.085);
        aMeasurements_sub->addRecord(445, 0.909, 0.085, 0.085);
        aMeasurements_sub->addRecord(450, 0.909, 0.084, 0.084);
        aMeasurements_sub->addRecord(455, 0.909, 0.084, 0.084);
        aMeasurements_sub->addRecord(460, 0.910, 0.084, 0.084);
        aMeasurements_sub->addRecord(465, 0.910, 0.084, 0.084);
        aMeasurements_sub->addRecord(470, 0.910, 0.084, 0.084);
        aMeasurements_sub->addRecord(475, 0.911, 0.084, 0.084);
        aMeasurements_sub->addRecord(480, 0.911, 0.084, 0.084);
        aMeasurements_sub->addRecord(485, 0.912, 0.084, 0.084);
        aMeasurements_sub->addRecord(490, 0.912, 0.084, 0.084);
        aMeasurements_sub->addRecord(495, 0.912, 0.083, 0.083);
        aMeasurements_sub->addRecord(500, 0.912, 0.083, 0.083);
        aMeasurements_sub->addRecord(505, 0.912, 0.083, 0.083);
        aMeasurements_sub->addRecord(510, 0.912, 0.083, 0.083);
        aMeasurements_sub->addRecord(515, 0.912, 0.083, 0.083);
        aMeasurements_sub->addRecord(520, 0.912, 0.083, 0.083);
        aMeasurements_sub->addRecord(525, 0.912, 0.083, 0.083);
        aMeasurements_sub->addRecord(530, 0.913, 0.083, 0.083);
        aMeasurements_sub->addRecord(535, 0.913, 0.083, 0.083);
        aMeasurements_sub->addRecord(540, 0.913, 0.083, 0.083);
        aMeasurements_sub->addRecord(545, 0.912, 0.083, 0.083);
        aMeasurements_sub->addRecord(550, 0.912, 0.083, 0.083);
        aMeasurements_sub->addRecord(555, 0.912, 0.083, 0.083);
        aMeasurements_sub->addRecord(560, 0.912, 0.082, 0.082);
        aMeasurements_sub->addRecord(565, 0.912, 0.082, 0.082);
        aMeasurements_sub->addRecord(570, 0.911, 0.082, 0.082);
        aMeasurements_sub->addRecord(575, 0.911, 0.082, 0.082);
        aMeasurements_sub->addRecord(580, 0.910, 0.082, 0.082);
        aMeasurements_sub->addRecord(585, 0.910, 0.082, 0.082);
        aMeasurements_sub->addRecord(590, 0.909, 0.082, 0.082);
        aMeasurements_sub->addRecord(595, 0.909, 0.082, 0.082);
        aMeasurements_sub->addRecord(600, 0.908, 0.081, 0.081);
        aMeasurements_sub->addRecord(605, 0.908, 0.081, 0.081);
        aMeasurements_sub->addRecord(610, 0.908, 0.081, 0.081);
        aMeasurements_sub->addRecord(615, 0.907, 0.081, 0.081);
        aMeasurements_sub->addRecord(620, 0.906, 0.081, 0.081);
        aMeasurements_sub->addRecord(625, 0.905, 0.081, 0.081);
        aMeasurements_sub->addRecord(630, 0.905, 0.081, 0.081);
        aMeasurements_sub->addRecord(635, 0.904, 0.081, 0.081);
        aMeasurements_sub->addRecord(640, 0.904, 0.081, 0.081);
        aMeasurements_sub->addRecord(645, 0.903, 0.080, 0.080);
        aMeasurements_sub->addRecord(650, 0.903, 0.080, 0.080);
        aMeasurements_sub->addRecord(655, 0.902, 0.080, 0.080);
        aMeasurements_sub->addRecord(660, 0.902, 0.080, 0.080);
        aMeasurements_sub->addRecord(665, 0.901, 0.080, 0.080);
        aMeasurements_sub->addRecord(670, 0.901, 0.080, 0.080);
        aMeasurements_sub->addRecord(675, 0.900, 0.080, 0.080);
        aMeasurements_sub->addRecord(680, 0.899, 0.080, 0.080);
        aMeasurements_sub->addRecord(685, 0.898, 0.080, 0.080);
        aMeasurements_sub->addRecord(690, 0.898, 0.080, 0.080);
        aMeasurements_sub->addRecord(695, 0.896, 0.079, 0.079);
        aMeasurements_sub->addRecord(700, 0.896, 0.079, 0.079);
        aMeasurements_sub->addRecord(705, 0.896, 0.079, 0.079);
        aMeasurements_sub->addRecord(710, 0.895, 0.079, 0.079);
        aMeasurements_sub->addRecord(715, 0.894, 0.079, 0.079);
        aMeasurements_sub->addRecord(720, 0.893, 0.079, 0.079);
        aMeasurements_sub->addRecord(725, 0.892, 0.079, 0.079);
        aMeasurements_sub->addRecord(730, 0.892, 0.079, 0.079);
        aMeasurements_sub->addRecord(735, 0.891, 0.079, 0.079);
        aMeasurements_sub->addRecord(740, 0.890, 0.079, 0.079);
        aMeasurements_sub->addRecord(745, 0.890, 0.079, 0.079);
        aMeasurements_sub->addRecord(750, 0.889, 0.079, 0.079);
        aMeasurements_sub->addRecord(755, 0.887, 0.078, 0.078);
        aMeasurements_sub->addRecord(760, 0.887, 0.078, 0.078);
        aMeasurements_sub->addRecord(765, 0.886, 0.078, 0.078);
        aMeasurements_sub->addRecord(770, 0.886, 0.078, 0.078);
        aMeasurements_sub->addRecord(775, 0.885, 0.078, 0.078);
        aMeasurements_sub->addRecord(780, 0.884, 0.078, 0.078);
        aMeasurements_sub->addRecord(785, 0.883, 0.078, 0.078);
        aMeasurements_sub->addRecord(790, 0.882, 0.078, 0.078);
        aMeasurements_sub->addRecord(795, 0.881, 0.078, 0.078);
        aMeasurements_sub->addRecord(800, 0.881, 0.078, 0.078);
        aMeasurements_sub->addRecord(805, 0.880, 0.078, 0.078);
        aMeasurements_sub->addRecord(810, 0.880, 0.078, 0.078);
        aMeasurements_sub->addRecord(815, 0.879, 0.078, 0.078);
        aMeasurements_sub->addRecord(820, 0.878, 0.077, 0.077);
        aMeasurements_sub->addRecord(825, 0.877, 0.077, 0.077);
        aMeasurements_sub->addRecord(830, 0.877, 0.077, 0.077);
        aMeasurements_sub->addRecord(835, 0.876, 0.077, 0.077);
        aMeasurements_sub->addRecord(840, 0.875, 0.077, 0.077);
        aMeasurements_sub->addRecord(845, 0.874, 0.077, 0.077);
        aMeasurements_sub->addRecord(850, 0.875, 0.077, 0.077);
        aMeasurements_sub->addRecord(855, 0.875, 0.078, 0.078);
        aMeasurements_sub->addRecord(860, 0.872, 0.079, 0.079);
        aMeasurements_sub->addRecord(865, 0.872, 0.080, 0.080);
        aMeasurements_sub->addRecord(870, 0.871, 0.081, 0.081);
        aMeasurements_sub->addRecord(875, 0.871, 0.081, 0.081);
        aMeasurements_sub->addRecord(880, 0.870, 0.079, 0.079);
        aMeasurements_sub->addRecord(885, 0.869, 0.079, 0.079);
        aMeasurements_sub->addRecord(890, 0.869, 0.079, 0.079);
        aMeasurements_sub->addRecord(895, 0.869, 0.079, 0.079);
        aMeasurements_sub->addRecord(900, 0.869, 0.079, 0.079);
        aMeasurements_sub->addRecord(905, 0.868, 0.079, 0.079);
        aMeasurements_sub->addRecord(910, 0.868, 0.078, 0.078);
        aMeasurements_sub->addRecord(915, 0.868, 0.078, 0.078);
        aMeasurements_sub->addRecord(920, 0.867, 0.079, 0.079);
        aMeasurements_sub->addRecord(925, 0.867, 0.078, 0.078);
        aMeasurements_sub->addRecord(930, 0.867, 0.078, 0.078);
        aMeasurements_sub->addRecord(935, 0.866, 0.077, 0.077);
        aMeasurements_sub->addRecord(940, 0.866, 0.077, 0.077);
        aMeasurements_sub->addRecord(945, 0.866, 0.077, 0.077);
        aMeasurements_sub->addRecord(950, 0.866, 0.078, 0.078);
        aMeasurements_sub->addRecord(955, 0.865, 0.078, 0.078);
        aMeasurements_sub->addRecord(960, 0.865, 0.077, 0.077);
        aMeasurements_sub->addRecord(965, 0.865, 0.077, 0.077);
        aMeasurements_sub->addRecord(970, 0.865, 0.077, 0.077);
        aMeasurements_sub->addRecord(975, 0.865, 0.077, 0.077);
        aMeasurements_sub->addRecord(980, 0.865, 0.077, 0.077);
        aMeasurements_sub->addRecord(985, 0.864, 0.078, 0.078);
        aMeasurements_sub->addRecord(990, 0.864, 0.078, 0.078);
        aMeasurements_sub->addRecord(995, 0.864, 0.078, 0.078);
        aMeasurements_sub->addRecord(1000, 0.864, 0.078, 0.078);
        aMeasurements_sub->addRecord(1005, 0.864, 0.078, 0.078);
        aMeasurements_sub->addRecord(1010, 0.864, 0.078, 0.078);
        aMeasurements_sub->addRecord(1015, 0.863, 0.077, 0.077);
        aMeasurements_sub->addRecord(1020, 0.863, 0.077, 0.077);
        aMeasurements_sub->addRecord(1025, 0.863, 0.077, 0.077);
        aMeasurements_sub->addRecord(1030, 0.863, 0.077, 0.077);
        aMeasurements_sub->addRecord(1035, 0.863, 0.077, 0.077);
        aMeasurements_sub->addRecord(1040, 0.863, 0.077, 0.077);
        aMeasurements_sub->addRecord(1045, 0.863, 0.077, 0.077);
        aMeasurements_sub->addRecord(1050, 0.863, 0.077, 0.077);
        aMeasurements_sub->addRecord(1055, 0.863, 0.077, 0.077);
        aMeasurements_sub->addRecord(1060, 0.863, 0.076, 0.076);
        aMeasurements_sub->addRecord(1065, 0.863, 0.077, 0.077);
        aMeasurements_sub->addRecord(1070, 0.863, 0.077, 0.077);
        aMeasurements_sub->addRecord(1075, 0.863, 0.077, 0.077);
        aMeasurements_sub->addRecord(1080, 0.863, 0.076, 0.076);
        aMeasurements_sub->addRecord(1085, 0.863, 0.077, 0.077);
        aMeasurements_sub->addRecord(1090, 0.863, 0.077, 0.077);
        aMeasurements_sub->addRecord(1095, 0.863, 0.077, 0.077);
        aMeasurements_sub->addRecord(1100, 0.863, 0.076, 0.076);
        aMeasurements_sub->addRecord(1105, 0.863, 0.076, 0.076);
        aMeasurements_sub->addRecord(1110, 0.863, 0.077, 0.077);
        aMeasurements_sub->addRecord(1115, 0.863, 0.077, 0.077);
        aMeasurements_sub->addRecord(1120, 0.864, 0.077, 0.077);
        aMeasurements_sub->addRecord(1125, 0.864, 0.077, 0.077);
        aMeasurements_sub->addRecord(1130, 0.864, 0.077, 0.077);
        aMeasurements_sub->addRecord(1135, 0.864, 0.077, 0.077);
        aMeasurements_sub->addRecord(1140, 0.864, 0.076, 0.076);
        aMeasurements_sub->addRecord(1145, 0.864, 0.077, 0.077);
        aMeasurements_sub->addRecord(1150, 0.864, 0.077, 0.077);
        aMeasurements_sub->addRecord(1155, 0.864, 0.077, 0.077);
        aMeasurements_sub->addRecord(1160, 0.865, 0.077, 0.077);
        aMeasurements_sub->addRecord(1165, 0.864, 0.076, 0.076);
        aMeasurements_sub->addRecord(1170, 0.865, 0.077, 0.077);
        aMeasurements_sub->addRecord(1175, 0.865, 0.077, 0.077);
        aMeasurements_sub->addRecord(1180, 0.865, 0.077, 0.077);
        aMeasurements_sub->addRecord(1185, 0.865, 0.077, 0.077);
        aMeasurements_sub->addRecord(1190, 0.865, 0.077, 0.077);
        aMeasurements_sub->addRecord(1195, 0.865, 0.075, 0.075);
        aMeasurements_sub->addRecord(1200, 0.865, 0.077, 0.077);
        aMeasurements_sub->addRecord(1205, 0.866, 0.077, 0.077);
        aMeasurements_sub->addRecord(1210, 0.866, 0.076, 0.076);
        aMeasurements_sub->addRecord(1215, 0.866, 0.076, 0.076);
        aMeasurements_sub->addRecord(1220, 0.866, 0.077, 0.077);
        aMeasurements_sub->addRecord(1225, 0.867, 0.077, 0.077);
        aMeasurements_sub->addRecord(1230, 0.867, 0.077, 0.077);
        aMeasurements_sub->addRecord(1235, 0.866, 0.077, 0.077);
        aMeasurements_sub->addRecord(1240, 0.866, 0.076, 0.076);
        aMeasurements_sub->addRecord(1245, 0.867, 0.076, 0.076);
        aMeasurements_sub->addRecord(1250, 0.867, 0.076, 0.076);
        aMeasurements_sub->addRecord(1255, 0.868, 0.076, 0.076);
        aMeasurements_sub->addRecord(1260, 0.868, 0.077, 0.077);
        aMeasurements_sub->addRecord(1265, 0.868, 0.077, 0.077);
        aMeasurements_sub->addRecord(1270, 0.868, 0.078, 0.078);
        aMeasurements_sub->addRecord(1275, 0.869, 0.076, 0.076);
        aMeasurements_sub->addRecord(1280, 0.870, 0.076, 0.076);
        aMeasurements_sub->addRecord(1285, 0.869, 0.076, 0.076);
        aMeasurements_sub->addRecord(1290, 0.869, 0.077, 0.077);
        aMeasurements_sub->addRecord(1295, 0.870, 0.076, 0.076);
        aMeasurements_sub->addRecord(1300, 0.870, 0.077, 0.077);
        aMeasurements_sub->addRecord(1305, 0.870, 0.076, 0.076);
        aMeasurements_sub->addRecord(1310, 0.871, 0.076, 0.076);
        aMeasurements_sub->addRecord(1315, 0.871, 0.076, 0.076);
        aMeasurements_sub->addRecord(1320, 0.871, 0.076, 0.076);
        aMeasurements_sub->addRecord(1325, 0.871, 0.077, 0.077);
        aMeasurements_sub->addRecord(1330, 0.872, 0.077, 0.077);
        aMeasurements_sub->addRecord(1335, 0.873, 0.077, 0.077);
        aMeasurements_sub->addRecord(1340, 0.873, 0.076, 0.076);
        aMeasurements_sub->addRecord(1345, 0.874, 0.076, 0.076);
        aMeasurements_sub->addRecord(1350, 0.874, 0.076, 0.076);
        aMeasurements_sub->addRecord(1355, 0.873, 0.076, 0.076);
        aMeasurements_sub->addRecord(1360, 0.874, 0.077, 0.077);
        aMeasurements_sub->addRecord(1365, 0.874, 0.077, 0.077);
        aMeasurements_sub->addRecord(1370, 0.874, 0.076, 0.076);
        aMeasurements_sub->addRecord(1375, 0.875, 0.076, 0.076);
        aMeasurements_sub->addRecord(1380, 0.875, 0.077, 0.077);
        aMeasurements_sub->addRecord(1385, 0.875, 0.077, 0.077);
        aMeasurements_sub->addRecord(1390, 0.875, 0.076, 0.076);
        aMeasurements_sub->addRecord(1395, 0.875, 0.076, 0.076);
        aMeasurements_sub->addRecord(1400, 0.875, 0.076, 0.076);
        aMeasurements_sub->addRecord(1405, 0.875, 0.076, 0.076);
        aMeasurements_sub->addRecord(1410, 0.874, 0.076, 0.076);
        aMeasurements_sub->addRecord(1415, 0.874, 0.076, 0.076);
        aMeasurements_sub->addRecord(1420, 0.874, 0.076, 0.076);
        aMeasurements_sub->addRecord(1425, 0.876, 0.077, 0.077);
        aMeasurements_sub->addRecord(1430, 0.877, 0.076, 0.076);
        aMeasurements_sub->addRecord(1435, 0.878, 0.076, 0.076);
        aMeasurements_sub->addRecord(1440, 0.878, 0.076, 0.076);
        aMeasurements_sub->addRecord(1445, 0.878, 0.077, 0.077);
        aMeasurements_sub->addRecord(1450, 0.880, 0.077, 0.077);
        aMeasurements_sub->addRecord(1455, 0.880, 0.078, 0.078);
        aMeasurements_sub->addRecord(1460, 0.880, 0.076, 0.076);
        aMeasurements_sub->addRecord(1465, 0.881, 0.076, 0.076);
        aMeasurements_sub->addRecord(1470, 0.881, 0.077, 0.077);
        aMeasurements_sub->addRecord(1475, 0.882, 0.076, 0.076);
        aMeasurements_sub->addRecord(1480, 0.883, 0.076, 0.076);
        aMeasurements_sub->addRecord(1485, 0.883, 0.076, 0.076);
        aMeasurements_sub->addRecord(1490, 0.883, 0.077, 0.077);
        aMeasurements_sub->addRecord(1495, 0.883, 0.076, 0.076);
        aMeasurements_sub->addRecord(1500, 0.884, 0.076, 0.076);
        aMeasurements_sub->addRecord(1505, 0.885, 0.077, 0.077);
        aMeasurements_sub->addRecord(1510, 0.885, 0.076, 0.076);
        aMeasurements_sub->addRecord(1515, 0.885, 0.076, 0.076);
        aMeasurements_sub->addRecord(1520, 0.885, 0.077, 0.077);
        aMeasurements_sub->addRecord(1525, 0.886, 0.077, 0.077);
        aMeasurements_sub->addRecord(1530, 0.886, 0.077, 0.077);
        aMeasurements_sub->addRecord(1535, 0.887, 0.076, 0.076);
        aMeasurements_sub->addRecord(1540, 0.887, 0.077, 0.077);
        aMeasurements_sub->addRecord(1545, 0.887, 0.078, 0.078);
        aMeasurements_sub->addRecord(1550, 0.888, 0.078, 0.078);
        aMeasurements_sub->addRecord(1555, 0.887, 0.076, 0.076);
        aMeasurements_sub->addRecord(1560, 0.888, 0.077, 0.077);
        aMeasurements_sub->addRecord(1565, 0.889, 0.077, 0.077);
        aMeasurements_sub->addRecord(1570, 0.889, 0.076, 0.076);
        aMeasurements_sub->addRecord(1575, 0.889, 0.076, 0.076);
        aMeasurements_sub->addRecord(1580, 0.889, 0.077, 0.077);
        aMeasurements_sub->addRecord(1585, 0.889, 0.077, 0.077);
        aMeasurements_sub->addRecord(1590, 0.889, 0.077, 0.077);
        aMeasurements_sub->addRecord(1595, 0.890, 0.077, 0.077);
        aMeasurements_sub->addRecord(1600, 0.890, 0.077, 0.077);
        aMeasurements_sub->addRecord(1605, 0.889, 0.076, 0.076);
        aMeasurements_sub->addRecord(1610, 0.890, 0.076, 0.076);
        aMeasurements_sub->addRecord(1615, 0.890, 0.077, 0.077);
        aMeasurements_sub->addRecord(1620, 0.890, 0.077, 0.077);
        aMeasurements_sub->addRecord(1625, 0.889, 0.077, 0.077);
        aMeasurements_sub->addRecord(1630, 0.890, 0.077, 0.077);
        aMeasurements_sub->addRecord(1635, 0.891, 0.076, 0.076);
        aMeasurements_sub->addRecord(1640, 0.890, 0.076, 0.076);
        aMeasurements_sub->addRecord(1645, 0.890, 0.077, 0.077);
        aMeasurements_sub->addRecord(1650, 0.890, 0.077, 0.077);
        aMeasurements_sub->addRecord(1655, 0.890, 0.077, 0.077);
        aMeasurements_sub->addRecord(1660, 0.890, 0.076, 0.076);
        aMeasurements_sub->addRecord(1665, 0.890, 0.077, 0.077);
        aMeasurements_sub->addRecord(1670, 0.890, 0.077, 0.077);
        aMeasurements_sub->addRecord(1675, 0.890, 0.077, 0.077);
        aMeasurements_sub->addRecord(1680, 0.890, 0.077, 0.077);
        aMeasurements_sub->addRecord(1685, 0.890, 0.076, 0.076);
        aMeasurements_sub->addRecord(1690, 0.889, 0.076, 0.076);
        aMeasurements_sub->addRecord(1695, 0.889, 0.076, 0.076);
        aMeasurements_sub->addRecord(1700, 0.889, 0.076, 0.076);
        aMeasurements_sub->addRecord(1705, 0.889, 0.076, 0.076);
        aMeasurements_sub->addRecord(1710, 0.889, 0.075, 0.075);
        aMeasurements_sub->addRecord(1715, 0.889, 0.076, 0.076);
        aMeasurements_sub->addRecord(1720, 0.889, 0.076, 0.076);
        aMeasurements_sub->addRecord(1725, 0.888, 0.076, 0.076);
        aMeasurements_sub->addRecord(1730, 0.887, 0.075, 0.075);
        aMeasurements_sub->addRecord(1735, 0.887, 0.076, 0.076);
        aMeasurements_sub->addRecord(1740, 0.887, 0.076, 0.076);
        aMeasurements_sub->addRecord(1745, 0.887, 0.076, 0.076);
        aMeasurements_sub->addRecord(1750, 0.887, 0.075, 0.075);
        aMeasurements_sub->addRecord(1755, 0.887, 0.076, 0.076);
        aMeasurements_sub->addRecord(1760, 0.887, 0.076, 0.076);
        aMeasurements_sub->addRecord(1765, 0.886, 0.077, 0.077);
        aMeasurements_sub->addRecord(1770, 0.886, 0.076, 0.076);
        aMeasurements_sub->addRecord(1775, 0.886, 0.076, 0.076);
        aMeasurements_sub->addRecord(1780, 0.886, 0.075, 0.075);
        aMeasurements_sub->addRecord(1785, 0.885, 0.076, 0.076);
        aMeasurements_sub->addRecord(1790, 0.885, 0.075, 0.075);
        aMeasurements_sub->addRecord(1795, 0.885, 0.076, 0.076);
        aMeasurements_sub->addRecord(1800, 0.885, 0.076, 0.076);
        aMeasurements_sub->addRecord(1805, 0.885, 0.076, 0.076);
        aMeasurements_sub->addRecord(1810, 0.884, 0.077, 0.077);
        aMeasurements_sub->addRecord(1815, 0.884, 0.076, 0.076);
        aMeasurements_sub->addRecord(1820, 0.884, 0.076, 0.076);
        aMeasurements_sub->addRecord(1825, 0.883, 0.076, 0.076);
        aMeasurements_sub->addRecord(1830, 0.883, 0.074, 0.074);
        aMeasurements_sub->addRecord(1835, 0.883, 0.074, 0.074);
        aMeasurements_sub->addRecord(1840, 0.883, 0.074, 0.074);
        aMeasurements_sub->addRecord(1845, 0.882, 0.075, 0.075);
        aMeasurements_sub->addRecord(1850, 0.882, 0.075, 0.075);
        aMeasurements_sub->addRecord(1855, 0.882, 0.075, 0.075);
        aMeasurements_sub->addRecord(1860, 0.882, 0.076, 0.076);
        aMeasurements_sub->addRecord(1865, 0.882, 0.075, 0.075);
        aMeasurements_sub->addRecord(1870, 0.881, 0.075, 0.075);
        aMeasurements_sub->addRecord(1875, 0.881, 0.075, 0.075);
        aMeasurements_sub->addRecord(1880, 0.881, 0.074, 0.074);
        aMeasurements_sub->addRecord(1885, 0.880, 0.074, 0.074);
        aMeasurements_sub->addRecord(1890, 0.880, 0.075, 0.075);
        aMeasurements_sub->addRecord(1895, 0.880, 0.075, 0.075);
        aMeasurements_sub->addRecord(1900, 0.879, 0.076, 0.076);
        aMeasurements_sub->addRecord(1905, 0.879, 0.075, 0.075);
        aMeasurements_sub->addRecord(1910, 0.879, 0.075, 0.075);
        aMeasurements_sub->addRecord(1915, 0.879, 0.075, 0.075);
        aMeasurements_sub->addRecord(1920, 0.879, 0.076, 0.076);
        aMeasurements_sub->addRecord(1925, 0.879, 0.076, 0.076);
        aMeasurements_sub->addRecord(1930, 0.878, 0.075, 0.075);
        aMeasurements_sub->addRecord(1935, 0.878, 0.075, 0.075);
        aMeasurements_sub->addRecord(1940, 0.877, 0.075, 0.075);
        aMeasurements_sub->addRecord(1945, 0.877, 0.075, 0.075);
        aMeasurements_sub->addRecord(1950, 0.877, 0.074, 0.074);
        aMeasurements_sub->addRecord(1955, 0.877, 0.074, 0.074);
        aMeasurements_sub->addRecord(1960, 0.877, 0.074, 0.074);
        aMeasurements_sub->addRecord(1965, 0.877, 0.074, 0.074);
        aMeasurements_sub->addRecord(1970, 0.876, 0.074, 0.074);
        aMeasurements_sub->addRecord(1975, 0.876, 0.074, 0.074);
        aMeasurements_sub->addRecord(1980, 0.876, 0.074, 0.074);
        aMeasurements_sub->addRecord(1985, 0.875, 0.074, 0.074);
        aMeasurements_sub->addRecord(1990, 0.875, 0.074, 0.074);
        aMeasurements_sub->addRecord(1995, 0.875, 0.074, 0.074);
        aMeasurements_sub->addRecord(2000, 0.875, 0.073, 0.073);
        aMeasurements_sub->addRecord(2005, 0.875, 0.074, 0.074);
        aMeasurements_sub->addRecord(2010, 0.874, 0.074, 0.074);
        aMeasurements_sub->addRecord(2015, 0.874, 0.073, 0.073);
        aMeasurements_sub->addRecord(2020, 0.874, 0.073, 0.073);
        aMeasurements_sub->addRecord(2025, 0.873, 0.074, 0.074);
        aMeasurements_sub->addRecord(2030, 0.873, 0.073, 0.073);
        aMeasurements_sub->addRecord(2035, 0.873, 0.073, 0.073);
        aMeasurements_sub->addRecord(2040, 0.873, 0.074, 0.074);
        aMeasurements_sub->addRecord(2045, 0.873, 0.074, 0.074);
        aMeasurements_sub->addRecord(2050, 0.872, 0.074, 0.074);
        aMeasurements_sub->addRecord(2055, 0.872, 0.074, 0.074);
        aMeasurements_sub->addRecord(2060, 0.873, 0.074, 0.074);
        aMeasurements_sub->addRecord(2065, 0.873, 0.073, 0.073);
        aMeasurements_sub->addRecord(2070, 0.873, 0.073, 0.073);
        aMeasurements_sub->addRecord(2075, 0.872, 0.074, 0.074);
        aMeasurements_sub->addRecord(2080, 0.871, 0.074, 0.074);
        aMeasurements_sub->addRecord(2085, 0.872, 0.074, 0.074);
        aMeasurements_sub->addRecord(2090, 0.871, 0.073, 0.073);
        aMeasurements_sub->addRecord(2095, 0.870, 0.073, 0.073);
        aMeasurements_sub->addRecord(2100, 0.870, 0.073, 0.073);
        aMeasurements_sub->addRecord(2105, 0.871, 0.072, 0.072);
        aMeasurements_sub->addRecord(2110, 0.870, 0.072, 0.072);
        aMeasurements_sub->addRecord(2115, 0.870, 0.074, 0.074);
        aMeasurements_sub->addRecord(2120, 0.869, 0.074, 0.074);
        aMeasurements_sub->addRecord(2125, 0.868, 0.073, 0.073);
        aMeasurements_sub->addRecord(2130, 0.868, 0.074, 0.074);
        aMeasurements_sub->addRecord(2135, 0.866, 0.074, 0.074);
        aMeasurements_sub->addRecord(2140, 0.866, 0.075, 0.075);
        aMeasurements_sub->addRecord(2145, 0.866, 0.073, 0.073);
        aMeasurements_sub->addRecord(2150, 0.864, 0.072, 0.072);
        aMeasurements_sub->addRecord(2155, 0.862, 0.074, 0.074);
        aMeasurements_sub->addRecord(2160, 0.862, 0.073, 0.073);
        aMeasurements_sub->addRecord(2165, 0.861, 0.071, 0.071);
        aMeasurements_sub->addRecord(2170, 0.858, 0.070, 0.070);
        aMeasurements_sub->addRecord(2175, 0.856, 0.071, 0.071);
        aMeasurements_sub->addRecord(2180, 0.852, 0.070, 0.070);
        aMeasurements_sub->addRecord(2185, 0.850, 0.070, 0.070);
        aMeasurements_sub->addRecord(2190, 0.846, 0.070, 0.070);
        aMeasurements_sub->addRecord(2195, 0.843, 0.070, 0.070);
        aMeasurements_sub->addRecord(2200, 0.841, 0.071, 0.071);
        aMeasurements_sub->addRecord(2205, 0.839, 0.069, 0.069);
        aMeasurements_sub->addRecord(2210, 0.837, 0.069, 0.069);
        aMeasurements_sub->addRecord(2215, 0.835, 0.070, 0.070);
        aMeasurements_sub->addRecord(2220, 0.838, 0.068, 0.068);
        aMeasurements_sub->addRecord(2225, 0.837, 0.070, 0.070);
        aMeasurements_sub->addRecord(2230, 0.837, 0.072, 0.072);
        aMeasurements_sub->addRecord(2235, 0.837, 0.069, 0.069);
        aMeasurements_sub->addRecord(2240, 0.838, 0.071, 0.071);
        aMeasurements_sub->addRecord(2245, 0.838, 0.071, 0.071);
        aMeasurements_sub->addRecord(2250, 0.838, 0.068, 0.068);
        aMeasurements_sub->addRecord(2255, 0.838, 0.070, 0.070);
        aMeasurements_sub->addRecord(2260, 0.841, 0.069, 0.069);
        aMeasurements_sub->addRecord(2265, 0.844, 0.067, 0.067);
        aMeasurements_sub->addRecord(2270, 0.844, 0.066, 0.066);
        aMeasurements_sub->addRecord(2275, 0.843, 0.073, 0.073);
        aMeasurements_sub->addRecord(2280, 0.845, 0.072, 0.072);
        aMeasurements_sub->addRecord(2285, 0.844, 0.072, 0.072);
        aMeasurements_sub->addRecord(2290, 0.843, 0.076, 0.076);
        aMeasurements_sub->addRecord(2295, 0.846, 0.069, 0.069);
        aMeasurements_sub->addRecord(2300, 0.847, 0.072, 0.072);
        aMeasurements_sub->addRecord(2305, 0.840, 0.066, 0.066);
        aMeasurements_sub->addRecord(2310, 0.842, 0.070, 0.070);
        aMeasurements_sub->addRecord(2315, 0.841, 0.077, 0.077);
        aMeasurements_sub->addRecord(2320, 0.843, 0.072, 0.072);
        aMeasurements_sub->addRecord(2325, 0.843, 0.071, 0.071);
        aMeasurements_sub->addRecord(2330, 0.845, 0.070, 0.070);
        aMeasurements_sub->addRecord(2335, 0.844, 0.071, 0.071);
        aMeasurements_sub->addRecord(2340, 0.847, 0.074, 0.074);
        aMeasurements_sub->addRecord(2345, 0.849, 0.079, 0.079);
        aMeasurements_sub->addRecord(2350, 0.848, 0.071, 0.071);
        aMeasurements_sub->addRecord(2355, 0.850, 0.070, 0.070);
        aMeasurements_sub->addRecord(2360, 0.845, 0.067, 0.067);
        aMeasurements_sub->addRecord(2365, 0.849, 0.064, 0.064);
        aMeasurements_sub->addRecord(2370, 0.848, 0.067, 0.067);
        aMeasurements_sub->addRecord(2375, 0.842, 0.072, 0.072);
        aMeasurements_sub->addRecord(2380, 0.850, 0.070, 0.070);
        aMeasurements_sub->addRecord(2385, 0.843, 0.067, 0.067);
        aMeasurements_sub->addRecord(2390, 0.845, 0.065, 0.065);
        aMeasurements_sub->addRecord(2395, 0.840, 0.067, 0.067);
        aMeasurements_sub->addRecord(2400, 0.837, 0.068, 0.068);
        aMeasurements_sub->addRecord(2405, 0.845, 0.069, 0.069);
        aMeasurements_sub->addRecord(2410, 0.838, 0.071, 0.071);
        aMeasurements_sub->addRecord(2415, 0.833, 0.076, 0.076);
        aMeasurements_sub->addRecord(2420, 0.829, 0.072, 0.072);
        aMeasurements_sub->addRecord(2425, 0.832, 0.067, 0.067);
        aMeasurements_sub->addRecord(2430, 0.834, 0.061, 0.061);
        aMeasurements_sub->addRecord(2435, 0.829, 0.068, 0.068);
        aMeasurements_sub->addRecord(2440, 0.826, 0.074, 0.074);
        aMeasurements_sub->addRecord(2445, 0.821, 0.072, 0.072);
        aMeasurements_sub->addRecord(2450, 0.826, 0.072, 0.072);
        aMeasurements_sub->addRecord(2455, 0.831, 0.068, 0.068);
        aMeasurements_sub->addRecord(2460, 0.820, 0.062, 0.062);
        aMeasurements_sub->addRecord(2465, 0.815, 0.069, 0.069);
        aMeasurements_sub->addRecord(2470, 0.813, 0.060, 0.060);
        aMeasurements_sub->addRecord(2475, 0.827, 0.074, 0.074);
        aMeasurements_sub->addRecord(2480, 0.812, 0.073, 0.073);
        aMeasurements_sub->addRecord(2485, 0.827, 0.070, 0.070);
        aMeasurements_sub->addRecord(2490, 0.814, 0.085, 0.085);
        aMeasurements_sub->addRecord(2495, 0.824, 0.083, 0.083);
        aMeasurements_sub->addRecord(2500, 0.832, 0.090, 0.090);
        return aMeasurements_sub;
    }

    void SetUp() override
    {
        m_SampleData = getSubstrateMeasurements();
    }

public:
    std::shared_ptr<CSpectralSampleData> getSampleData() const
    {
        return m_SampleData;
    };
};

TEST_F(TestDeconstructors, TestMonoDeconstruct)
{

    const auto aSampleData = getSampleData();
    MonolithicInternalOpticalProperty prop = MonolithicDeconstruct(aSampleData);
    const auto ts = prop.ts;
    const auto rs = prop.rs;
    const auto taus = prop.taus;
    // Answers from Jacob's Matlab code, high tolerance.
    EXPECT_NEAR(0.9474, ts[0].value(), 1e-4);
    EXPECT_NEAR(0.9457, ts[1].value(), 1e-4);
    EXPECT_NEAR(0.9446, ts[2].value(), 1e-4);
    EXPECT_NEAR(0.9451, ts[3].value(), 1e-4);
    EXPECT_NEAR(0.9455, ts[4].value(), 1e-4);

    EXPECT_NEAR(0.0526, rs[0].value(), 1e-4);
    EXPECT_NEAR(0.0543, rs[1].value(), 1e-4);
    EXPECT_NEAR(0.0554, rs[2].value(), 1e-4);
    EXPECT_NEAR(0.0549, rs[3].value(), 1e-4);
    EXPECT_NEAR(0.0545, rs[4].value(), 1e-4);

    EXPECT_NEAR(0.2250, taus[0].value(), 1e-4);
    EXPECT_NEAR(0.3097, taus[1].value(), 1e-4);
    EXPECT_NEAR(0.3932, taus[2].value(), 1e-4);
    EXPECT_NEAR(0.4766, taus[3].value(), 1e-4);
    EXPECT_NEAR(0.5643, taus[4].value(), 1e-4);
}
